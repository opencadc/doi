#!/bin/sh

# Store the git root directory
GIT_ROOT=$(pwd)

# Change to frontend directory where package.json and scripts are located
cd rafts/frontend || exit 0

# Ensure we have the right PATH for node and npm
export PATH="/Users/szautkin/.nvm/versions/node/v22.16.0/bin:$PATH"

# Clear any problematic git config parameters
unset GIT_CONFIG_PARAMETERS

# Run lint-staged on staged files
npx lint-staged

# Update version info
npx tsx scripts/update-version.ts

# Add updated version file (use path relative to git root)
cd "$GIT_ROOT"
git add rafts/frontend/src/version.json
